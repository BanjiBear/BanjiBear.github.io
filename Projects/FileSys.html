<!DOCTYPE html>
<html>
<head>
  <!-- Meta is the information that will not be shown on the screen -->
  <!-- author: The name of the webpage -->
  <meta name="author" content="Banjibear">
  <!-- Refreshes the webpage every x seconds: 60 for the surrent case -->
  <meta name="refresh" content="60">
  <!-- Setting the viewport to make your website look good on all devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Projects - File System Simulator </title> <!-- Name or the tile shown on the tab -->
  <style>

  :root{
    --purple: #cf91c9;
    --yellow: #ffab42;
    --blue: #4d80ad;
    --red: #ff5261;
    --green: #39b6b5;
    --equal: #ff724c;
    --comments: #9fa6b3;
  }

  body{
    background-color: black;
    color: ghostwhite;
  }
  ::selection{
    color:  white;
    background-color: green;
  }
  .icon {
    /* Reference: https://stackoverflow.com/questions/53276676/icon-inside-button-not-centered-in-iphone */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%)
  }

  /* The following are the Constant Settings/Styles in all pages */

  /* Home button */
  /* Using the same name in all Pages */
  .b2{
    position: absolute;
    bottom: 25px;
    right: 5px;
    width: 50px;
    height: 50px;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 50%;
    background-color: white; 
    border: 2px solid transparent;
  }
  .b2:hover {
    /* change color */
    background-color: #e7e7e7;
    color: white;
    /* hover shadow */
    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24),0 17px 50px 0 rgba(0,0,0,0.19);
  }
  .b2:active {
    background-color: #00000;
    box-shadow: 0 5px #666;
    transform: translateY(4px);
  }

  .bottomFooter{
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
  }

  /* The sidebar */
  .sidebar {
    height: 100%; 
    width: 0; 
    position: fixed; 
    z-index: 1; /* Stay on top */
    top: 0;
    left: 0;
    background-color: black;
    overflow-x: hidden; 
    padding-top: 60px; 
    transition: 0.5s; 
  }
  /* The sidebar links */
  .sidebar a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 25px;
    color: grey;
    display: block;
    transition: 0.3s;
  }
  .sidebar a:hover {
    color: white;
  }
  .sidebar .closeButton {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 36px;
    margin-left: 50px;
  }
  .openButton {
    font-size: 20px;
    cursor: pointer;
    background-color: transparent;
    color: white;
    padding: 10px 15px;
    border: none;
  }
  .openButton:hover {
    background-color: #444;
  }
  /* Style page content - use this if you want to push the page content to the right when you open the side navigation */
  #main {
    transition: margin-left .5s; /* If you want a transition effect */
    padding: 20px;
  }
  /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
  @media screen and (max-height: 450px) {
    .sidebar {padding-top: 15px;}
    .sidebar a {font-size: 18px;}
  }

  .content{
    margin-left: 10vw;
    margin-right: 10vw;
    font-family: "Lucida Console", "Courier New", monospace;
  }
  .box{ max-width: 35vw;}
  .box_align{ display: inline-flex;}
  .box_align_margin{ margin-left: 10vw; }
  .code{
    width: 100%;
    height: 50vh;
    overflow:auto;
    background-color: #2e3842;
    border-radius: 10px;
    padding: 10px;
  }
  @media only screen and (max-width: 620px){
    .content{
      width: 100%;
      margin: 0;
    }
    .box, .box_align{
      max-width: 100%;
      display: block;
    }
    .box_align_margin{
      margin: 0;
    }
  }


  </style>
</head>
<body>

  <div id="mySidebar" class="sidebar">
    <a href="javascript:void(0)" class="closeButton" onclick="closeNav()">&times;</a>
    <a href="../AboutMe.html"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand">About Me</b> </a>
    <a href="https://drive.google.com/file/d/1sUz0Q3nxzcKmmvESOlINPyJkDoz2tYtR/view?usp=sharing" target="_blank"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand">Resume</b> </a>
    <a href="../Projects.html"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand"><ion-icon name="terminal-outline"></ion-icon> Projects</b> </a>
    <a href="../Albums.html"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand">Albums</b> </a>
    <a href="" onclick="alert('Sorry! This pager is not available yet &#x1F625;');"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand">Foodie</b> </a>
    <a href="../Contact.html"> <h1 style="color:ghostwhite; font: 15.0px Bradley Hand">Contact</b> </a>
  </div>
  <div id="main">
    <div style="text-align:left">
      <button class="openButton" onclick="openNav()">&#9776;</button>
    </div>
  </div>

  <img src="filesystem.jpg" style="width: 100%;">
  
  <div class="content">
    <p style="color: grey;">File System application/OOP/Group Prject</p>
    <h1>In-Memory Virtual File System</h1>
    <hr style="border: 3px solid white; border-radius: 10px;">

    <div class="box_align">
      <div class="box">
        <h2>About</h2>
        <p>The goal of this project is to develop an in-memory Virtual File System (VFS), named the Comp VFS (CVFS), in Java. A VFS is usually built on top of a host file system to enable uniform access to files located in different host file systems, while the CVFS simulates a file system in memory.</p>
      </div>
      <div class="box">
        <h2 class="box_align_margin">Timeline</h2>
        <p class="box_align_margin">September 2020 &#8722; November 2020</p>
        <h2 class="box_align_margin">Note</h2>
        <p class="box_align_margin"></p>
      </div>
    </div>

    <hr><h2>In-Memory Virtual File System</h2>
    <p>The CVFS provides a command line interface (CLI) tool to facilitate the use of virtual disks, and some of the requirements for the CLI tool are as the following. Here we use symbol ‘$’ to denote the working directory and symbol ‘:’ to separate the file names in a path. For example, path “$:xyz” refers to a file named “xyz” inside the working directory. Depending on whether the file actually exists in the working directory or not, the path may be valid or invalid.</p>
    <p>The system operates on one virtual disk at a time; Each virtual disk has a maximum size and may contain as many files, i.e., documents and directories, as allowed by that size; For each document, the virtual disk maintains its name, type, and content, all of type String; For each directory, the virtual disk maintains its name of type String and the list of files directly contained in it; Only digits and English letters are allowed in file names, and each file name may have at most 10 characters; Only documents of types txt, java, html, and css are allowed in the system; The size of a document is calculated as 40+content.length()*2, and the size of a directory is calculated as 40 plus the total size of its contained files.</p>
    <p>All the commands for the file system are as follows: </p>
    <ul>
      <li style="color:green"><b>Command: newDisk diskSize</b></li>
      <p>The tool should support the creation of a new disk with a specified maximum size.<br>Effect: Creates a new virtual disk with the specified maximum size. The previous working disk, if any, is closed; The newly created disk is set to be the working disk of the system, and the working directory is set to be the root directory of the disk.</p>

      <li style="color:green"><b>Command: newDoc docName docType docContent</b></li>
      <p>The tool should support the creation of a new document in the working directory.<br>Effect: Creates a new document in the working directory with the specified name, type, and content.</p>

      <li style="color:green"><b>Command: newDir dirName</b></li>
      <p>The tool should support the creation of a new directory in the working directory.<br>Effect: Creates a new directory in the working directory with the specified name.</p>

      <li style="color:green"><b>Command: delete fileName</b></li>
      <p>The tool should support the deletion of an existing file in the working directory.<br>Effect: Delete an existing file with the specified name from the working directory.</p>

      <li style="color:green"><b>Command: rename oldFileName newFileName</b></li>
      <p>The tool should support the rename of an existing file in the working directory.<br>Effect: Rename an existing file in the working directory from oldFileName to newFileName.</p>

      <li style="color:green"><b>Command: changeDir dirName</b></li>
      <p>The tool should support the change of working directory.<br>Effect: If there is a directory with the specified name in the working directory, use that directory as the new working directory; If dirName is “..”, i.e., two dots, and the working directory is not the root directory of the working disk, use the parent directory of the working directory as the new working directory.</p>

      <li style="color:green"><b>Command: list</b></li>
      <p>The tool should support listing all files direclty contained in the working directory.<br>Effect: List all the files directly contained in the working directory. For each document, list the name, type, and size; For each directory, list the name and size. Report the total number and size of files listed.</p>

      <li style="color:green"><b>Command: rList</b></li>
      <p>The tool should support recursively listing all files in the working directory.<br>Effect: List all the files contained in the working directory. For each document, list the name, type, and size; For each directory, list the name and size. Use indentation to indicate the level of each file. Report the total number and size of files listed.</p>

      <li style="color:green"><b>Command: newSimpleCri criName attrName op val</b></li>
      <p>The tool should support the construction of simple criteria.<br>Effect: Construct a simple criterion that can be referenced by criName. A criName contains exactly two English letters, and attrName is either name, type, or size. If attrName is name, op must be contains and val must be a string in double quote; If attrName is type, op must be equals and val must be a string in double quote; If attrName is size, op can be >, <, >=, <=, ==, or !=, and val must be an integer.</p>

      <li style="color:green"><b>Criterion name: IsDocument</b></li>
      <p>The tool should support a simple criterion to check whether a file is a document.<br>Effect: Evaluates to true if and only if on a document.</p>

      <li style="color:green"><b>Command: newNegation criName1 criName2</b></li>
      <li style="color:green"><b>Command: newBinaryCri criName1 criName3 logicOp criName4</b></li>
      <p>The tool should support the construction of composite criteria.<br>Effect: Construct a composite criterion that can be referenced by criName1. The new criterion constructed using command newNegation is the negation of an ex- isting criterion named criName2; The new criterion constructed using command newBinaryCri is criName3 op criName4, where criName3 and criName4 are two existing criteria, while logicOp is either && or ||.</p>

      <li style="color:green"><b>Command: printAllCriteria</b></li>
      <p>The tool should support the printing of all defined criteria.<br>Effect: Print out all the criteria defined. All criteria should be resolved to the form containing only attrName, op, val, logicOp, or IsDocument.</p>

      <li style="color:green"><b>Command: search criName</b></li>
      <p>The tool should support searching for files in the working directory based on an existing criterion.<br>Effect: List all the files directly contained in the working directory that satisfy criterion criName. Report the total number and size of files listed.</p>

      <li style="color:green"><b>Command: rSearch criName</b></li>
      <p>The tool should support recursively searching for files in the working directory based on an existing criterion.<br>Effect: List all the files contained in the working directory that satisfy criterion criName. Report the total number and size of files listed.</p>
    </ul>
    
    <hr><h2>System Architecture</h2>
    <div class="box_align">
      <div class="box">
        <img src="UML.png" style="max-width: 100%; background-color: white;">
      </div>
      <div class="box">
        <p class="box_align_margin">The UI class is responsible for user interactivity with the program. It displays output to the console in a human readable format and accepts input from the user. The output includes file listing, command results, error messages and more. The input is mostly commands such as those for creating a file, a criterion or listing files in the current working directory.</p>
        <p class="box_align_margin">The UI class sends user commands to the CommandController class. The CommandController interprets commands and decides which operation to carry out based on the type of command. The CommandController class delegates command execution to the CVFS class.</p>
      </div>
    </div>

    <p>The <b>CVFS</b> class contains all the business logic for the application. The class exposes methods to create files, documents and criteria. Other functions include listing and searching files in the working directory or recursively.</p>

    <p>The <b>CVFS</b> class however delegates some of the tasks to other the <b>VirtualDisk</b> class. The <b>VirtualDisk</b> class represents a virtual disk. There can only be one virtual disk at a time from the <b>CVFS</b> perspective. The virtual disk handles some disk related tasks such as getting the current working directory path and switching directories.</p>

    <p>The <b>VirtualDisk</b> class maintains a hierarchy of <b>File</b> class objects. The <b>File</b> class is an abstract class that represents both documents and directories. A document is represented by the <b>Document</b> class. The <b>Document</b> class defines the type of document, content and knows how to compute the size of the document based on the content. The <b>Directory</b> class models a directory. It defines the set of <b>File</b> objects it contains and knows how to compute its size based on its contents.</p>

    <p>Additionally, the VirtualDisk class defines the set of criteria that can be used to search for files in it. The abstract class FileCriterion is the one any other file criterion must inherit from. It defines a common property such as a criterion name and the validation of the name upon initialization. The FileCriterion class also defines the abstract method used to check if files meet the criterion.</p>

    <p>A SimpleCriterion class represents criteria that are built from scratch (they are not built by using other criteria). Concrete classes that inherit from the SimpleCriterion class are the FileTypeCriterion (validates documents based on their type), FileNameCriterion (validates files based on their names), FileSizeCriterion (validates files based on their size) and the IsDocumentCriterion class which checks whether a file is a document or not.</p>

    <p>There are composite criteria that are built from existing FileCriterion objects. These are the BinaryCompositeCriterion and the NegationCompositeCriterion.<br><br>The BinaryCompositeCriterion is built from two FileCriterion objects and a logical operator. The NegativeCompositeCriterion is built from the negation of an existing FileCriterion.</p>

    <p>The Action class is used by the CVFS to encapsulate tasks that can be undone or redone. The CVFS maintains a stack of Action objects and unwinds them during an “undo” or “redo” operation. For example, when an action is done, it is pushed onto the stack. An “undo” operation pops the action from the stack and executes it.</p>

    <p>The Bucket class is an inner class of the CVFS class. When doing a recursive retrieval of files starting from the working directory, the Bucket class is used to group the files according to the level the search was made. The deeper the files were found, the higher the “level” in the Bucket class.</p>

    <p>Finally, the Application class is used to launch the application. It instantiates the CVFS, UI and CommandController classes and then asks the UI to display the starter user interface, so that the user can proceed from there.</p>

    <hr><h2 style="display: inline-flex;">Snipped Source Code</h2><p style="color: grey; display: inline-flex; margin: 10px; font-size: 5%;">Update: 1 MAR, 2022</p>
    <div class="code"><pre style="max-width: 10%;">package hk.edu.polyu.comp.comp2021.cvfs.controller;

import hk.edu.polyu.comp.comp2021.cvfs.model.CVFS;
import hk.edu.polyu.comp.comp2021.cvfs.model.File;
import hk.edu.polyu.comp.comp2021.cvfs.model.criteria.FileCriterion;
import hk.edu.polyu.comp.comp2021.cvfs.view.UI;

import java.util.List;

/**
 * The command controller interpets each
 * command and invokes the appropriate
 * service from the CVFS.
 */
public class CommandController {
    private final CVFS cvfs;

    /**
     * Constructor.
     *
     * @param cvfs The CVFS instance on which to forward command requests.
     */
    public CommandController(CVFS cvfs) {
        this.cvfs = cvfs;
    }

    /**
     * @return Return the path of the current working directory.
     */
    public String getCurrentPath() {
        return cvfs.getWorkingDirPath();
    }

    private Long parseLongOrNull(String longStr) {
        try {
            return Long.parseLong(longStr);
        } catch (Exception e) {
            return null;
        }
    }

    /**
     * @param command The command to be executed.
     */
    public void executeCommand(String command) {
        String[] commandSplit = command.split(" ");
        switch (commandSplit[0]) {
            case "newDisk":
                // check the parts of the 'newDisk' command.
                if (commandSplit.length != 2) {

                    UI.printError("Could not create disk due " +
                            "to bad command format. Try again with:" +
                            " newDisk <diskSize> where '<diskSize>' is the size of the disk");
                    return;
                }

                // check the value for the disksize.
                Long diskSize = parseLongOrNull(commandSplit[1]);
                if (diskSize == null) {
                    UI.printError("Bad value for the the disksize: " + commandSplit[1]);
                    return;
                }

                // now execute the command.
                cvfs.newDisk(diskSize);

                UI.printSuccess("Created new disk successfully!");
                break;
            case "newDoc":
                // check if the parts of the 'newDoc' command
                if (commandSplit.length < 4) {
                    System.out.println("\nCould not create new document due to a bad command format. Try again" +
                            " with: newDoc docName docType docContent\n");
                    return;
                }


                // group the values from the third index all the way the last array index
                StringBuilder builder = new StringBuilder();
                for(int i = 3; i < commandSplit.length; i++){
                    builder.append(commandSplit[i]);
                }

                // execute the command
                try {
                    cvfs.newDocument(commandSplit[1], commandSplit[2], builder.toString());
                    UI.printSuccess("The document was created successfully!");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "newDir":
                // check if the parts of the 'newDir' are okay
                if (commandSplit.length != 2) {

                    UI.printError("Could not create directory due to a bad command format. " +
                            "Try again with: " + "newDir dirName");
                    return;
                }

                // execute the command
                try {
                    cvfs.newDirectory(commandSplit[1]);
                    UI.printSuccess("Created directory successfully!");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "delete":
                // check if the parts of the 'delete' are okay
                if (commandSplit.length != 2) {
                    UI.printError("Could not delete file due a bad command format. " +
                            "Try again with: delete fileName");
                    return;
                }

                try {
                    // execute the command
                    cvfs.deleteFile(commandSplit[1]);
                    UI.printSuccess("Deleted file successfully!");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "rename":
                // check if the parts of the 'rename' command are okay.
                if (commandSplit.length != 3) {
                    UI.printError("Bad command format. Try again with: rename oldName newName");
                    return;
                }

                try {
                    // execute the rename command
                    cvfs.renameFile(commandSplit[1], commandSplit[2]);
                    UI.printSuccess("Renamed file successfully");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "changeDir":
                // check command format
                if (commandSplit.length != 2) {
                    UI.printError("Bad comand format. Try again with: changeDir dirName");
                    return;
                }

                try {
                    // execute command
                    cvfs.changeDir(commandSplit[1]);
                    UI.printSuccess("Changed to new directory");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }

                break;
            case "list":
                // execute the list command
                List<File> fileList = cvfs.list();
                UI.printFileList(fileList);
                break;
            case "rList":
                // execute the rList command
                List<CVFS.Bucket> fileBuckets = cvfs.rList();
                UI.printFilesRecursively(fileBuckets);
                break;
            case "newSimpleCri":
                // check the command format
                if (commandSplit.length != 5) {

                    UI.printError("Bad command format. " +
                            "Try again with: newSimpleCri criName attrName op val");
                    return;
                }
                try {
                    cvfs.createSimpleCriterion(commandSplit[1], commandSplit[2], commandSplit[3], commandSplit[4]);
                    UI.printSuccess("Created criterion: " + commandSplit[1] + " successfully!");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "newNegation":
                if (commandSplit.length != 3) {
                    UI.printError("Bad command formt. Try again with: newNegation criName1 criName2");
                    return;
                }

                try {
                    cvfs.createNegationCriterion(commandSplit[1], commandSplit[2]);
                    UI.printSuccess("Created criterion: " + commandSplit[1] + " successfully!");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;

            case "newBinaryCri":
                if (commandSplit.length != 5) {
                    UI.printError("Bad comand format. " +
                            "Try again with: newBinaryCri criName criName1 logicOp criName2");
                    return;
                }
                try {
                    cvfs.createBinaryCriterion(commandSplit[1], commandSplit[2], commandSplit[4], commandSplit[3]);
                    UI.printSuccess("Created criterion: " + commandSplit[1] + " successfully");
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;

            case "printAllCriteria":
                List<FileCriterion> criteria = cvfs.getAllCriteria();
                UI.printAllCriteria(criteria);
                break;

            case "search":
                if(commandSplit.length != 2){
                    UI.printError("Bad command format. Try again with: search criName");
                    return;
                }

                try {
                    List<File> files = cvfs.searchByCriterion(commandSplit[1]);
                    UI.printFileList(files);
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }

                break;
            case "rSearch":
                if(commandSplit.length != 2){
                    UI.printError("Bad command format. Try again with: rSearch criName");
                    return;
                }

                try {
                    List<CVFS.Bucket> files = cvfs.searchRecursivelyByCriterion(commandSplit[1]);
                    UI.printFilesRecursively(files);
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            case "undo":

                if(commandSplit.length != 1) {
                    UI.printError("Bad command format. Try again with: undo");
                    return;
                }

                try {
                    cvfs.undo();
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }

                break;
            case "redo":
                if(commandSplit.length != 1){
                    UI.printError("Bad command format. Try again with: redo");
                    return;
                }
                cvfs.redo();
                break;
            case "store":
                if(commandSplit.length != 2){
                    UI.printError("Bad command format. Try again with: store fileName");
                    return;
                }
                try {
                    cvfs.store(commandSplit[1]);
                } catch (Exception e) {
                    UI.printError(e.getMessage());
                }
                break;
            case "load":
                if(commandSplit.length != 2){
                    UI.printError("Bad command format. Try again with: load fileName");
                    return;
                }

                try {
                    cvfs.load(commandSplit[1]);
                } catch (Exception e){
                    UI.printError(e.getMessage());
                }
                break;
            default:
                UI.printError("Bad command. Check and try again.");
        }

    }
}
</pre></div>
<a href="https://github.com/BanjiBear/In-Memory-Virtual-File-System" target="_blank" style="color: grey;"><p>Open Source Code</p></a>

    <hr><h2>Development Team</h2>
    <a href="https://www.linkedin.com/in/yi-pu-chen-535040194" target="_blank" title="Tommy"><img src="banjibear.jpg" style="width:200px; height:200px; object-fit:cover; border-radius:50%; margin: 5px;"></a>
    <a href="https://blog.csdn.net/weixin_39591031?spm=1000.2115.3001.5343" target="_blank" title="Xavier"><img src="Xav.jpg" style="width:200px; height:200px; object-fit:cover; border-radius:50%; margin: 5px;"></a>
    <a href="https://linkedin.com/in/win-hong-chai-815126206" target="_blank" title="James"><img src="James.jpg" style="width:200px; height:200px; object-fit:cover; border-radius:50%; margin: 5px;"></a>
    <a href="mailto:yangxiaolong.xie@connect.polyu.hk" target="_blank" title="Bruce"><img src="nobody.jpg" style="width:200px; height:200px; object-fit:cover; border-radius:50%; margin: 5px;"></a>

  </div>



  <div class="bottomFooter">
    <button class="b2" style="font-size: 25px;" onclick="window.location.href='../index.html';"><i class="icon"><ion-icon name="person-outline"></ion-icon></i></button>
  </div>  

<script>

  /* Set the width of the sidebar to 250px and the left margin of the page content to 250px */
  function openNav() {
    document.getElementById("mySidebar").style.width = "250px";
    document.getElementById("main").style.marginLeft = "250px";
  }

  /* Set the width of the sidebar to 0 and the left margin of the page content to 0 */
  function closeNav() {
    document.getElementById("mySidebar").style.width = "0";
    document.getElementById("main").style.marginLeft = "0";
  }

</script>

  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>


</body>
</html>

